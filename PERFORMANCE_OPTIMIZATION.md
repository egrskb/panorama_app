# Оптимизация производительности спектра

## Проблема
Ваше приложение работает с **29,750 точками** спектра (при bin_width = 200 кГц), что вызывает:
- Глюки UI
- Зависания в конце сканирования
- Медленную отрисовку

## Решение
Увеличьте `bin_width` с **200 кГц до 800 кГц** для улучшения производительности в **4 раза**.

## Что изменилось

### 1. Конфигурация по умолчанию
- **Было**: `bin_hz: 200_000` (200 кГц)
- **Стало**: `bin_hz: 800_000` (800 кГц)

### 2. Количество точек
- **Было**: 29,750 точек
- **Стало**: ~7,437 точек
- **Улучшение**: в 4 раза меньше точек

### 3. UI производительность
- **Было**: Медленная отрисовка, глюки
- **Стало**: Плавная работа, стабильный UI

## Файлы изменений

1. `panorama/shared/config.py` - конфигурация по умолчанию
2. `panorama/drivers/base.py` - класс SweepConfig
3. `panorama/features/spectrum/view.py` - UI элементы
4. `panorama/features/spectrum/service.py` - оптимизация SweepAssembler

## Дополнительные оптимизации

### Автоматический даунсемплинг
- При количестве точек > 10,000 автоматически применяется даунсемплинг
- Сохраняется качество данных через усреднение

### Улучшенное логирование
- Интервал логирования увеличен с 50 до 200 сегментов
- Меньше нагрузки на консоль

### Оптимизированная интерполяция
- Ограничение на количество заполняемых дырок (максимум 5%)
- Более эффективные алгоритмы

## Как применить изменения

1. **Перезапустите приложение** - новые настройки применятся автоматически
2. **Или измените вручную** в UI: установите "Bin (кГц)" = 800

## Проверка результата

После изменений в логах вы увидите:
```
[SweepAssembler] Configured: 50.0-6000.0 MHz, 7437 bins, bin_width=800.0 kHz
[SweepAssembler] WARNING: Large number of bins (7437) may impact UI performance
```

## Альтернативные настройки

Если нужна еще лучшая производительность:
- `bin_width = 1.6 МГц` → ~3,718 точек
- `bin_width = 3.2 МГц` → ~1,859 точек

## Совместимость

- Все существующие функции сохранены
- Качество спектра остается приемлемым для большинства применений
- Автоматический даунсемплинг для критичных случаев
